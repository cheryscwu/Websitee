<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Design Selection | Saibai Island Water & Sanitation Project</title>
<style>
  :root{--brand:#004d40;--brand2:#00796b;--ink:#0f2723;--bg:#f6fbfa;--good:#0ea5a5}
  html{scroll-behavior:smooth}
  *{box-sizing:border-box}
  body{margin:0;font-family:Segoe UI,system-ui,-apple-system,Arial,sans-serif;background:var(--bg);color:var(--ink);font-size:1.06rem;line-height:1.72}

  /* NAV */
  header{background:var(--brand);color:#fff;position:sticky;top:0;z-index:999}
  nav ul{margin:0;padding:0;display:flex;list-style:none;align-items:center}
  nav li{position:relative}
  nav a{display:block;padding:16px 22px;color:#fff;text-decoration:none;font-weight:800}
  nav li:hover>a{background:var(--brand2)}
  .dropdown-content{display:none;position:absolute;background:var(--brand);min-width:240px;box-shadow:0 8px 20px rgba(0,0,0,.2)}
  .dropdown-content a{display:block;padding:14px 18px}
  nav li:hover>.dropdown-content{display:block}
  .sub-dropdown{position:relative}
  .sub-dropdown-content{display:none;position:absolute;left:240px;top:0;background:#0c665b;min-width:240px;box-shadow:0 8px 20px rgba(0,0,0,.2)}
  .sub-dropdown:hover .sub-dropdown-content{display:block}

  /* HERO */
  .hero{background:linear-gradient(135deg,rgba(0,77,64,.9),rgba(0,121,107,.72)),url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1920&auto=format&fit=crop') center/cover no-repeat;color:#fff;text-align:center;padding:90px 24px}
  .hero h1{margin:0 0 6px;font-size:2.6rem}
  .breadcrumb{opacity:.95;font-size:1rem}
  .breadcrumb a{color:#b2dfdb;text-decoration:none}.sep{margin:0 .4rem;opacity:.7}

  /* LAYOUT */
  main{max-width:1200px;margin:36px auto 100px;padding:0 24px}
  h2{color:#0a5f56;margin:22px 0 10px}
  .reveal{opacity:0;transform:translateY(16px);transition:opacity .6s ease,transform .6s ease}
  .show{opacity:1;transform:none}
  .callout{background:#ecfffd;border-left:6px solid var(--brand2);border-radius:12px;padding:20px 22px;box-shadow:0 10px 22px rgba(0,0,0,.06)}
  .pill{display:inline-block;background:#e0f7f5;color:#034d45;border:1px solid #bfece7;border-radius:999px;padding:6px 10px;font-size:.9rem;font-weight:800}

  /* Weights – 强化可视化 */
  .weights-wrap{border-radius:16px}
  .weights{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
  .w{position:relative;background:#fff;border:1px solid #dbeee9;border-radius:14px;padding:16px 16px 14px;box-shadow:0 10px 22px rgba(0,0,0,.05)}
  .w b{display:block;margin-bottom:6px}
  .meter{position:relative;height:14px;border-radius:999px;overflow:hidden;background:#e7f7f4;border:1px solid #d6efe8;margin-top:10px}
  .fill{width:0;height:100%;transition:width 1.1s ease;box-shadow:0 0 0 1px rgba(0,0,0,.04) inset}
  .w[data-weight="25"] .fill{background:linear-gradient(90deg,#06b6d4,#14b8a6)}
  .w[data-weight="20"] .fill{background:linear-gradient(90deg,#38bdf8,#0ea5e9)}
  .w[data-weight="15"] .fill{background:linear-gradient(90deg,#a78bfa,#8b5cf6)}
  .pct-chip{position:absolute;right:10px;top:-26px;background:#fff;border:1px solid #cdeee8;border-radius:999px;padding:2px 9px;font-weight:900;color:#0e6e63;font-size:.9rem;box-shadow:0 6px 12px rgba(0,0,0,.08)}
  .w.max .meter{outline:2px solid #10b3b3}
  .w.max .pct-chip{color:#0b8f85;border-color:#95efe6}
  @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(16,179,179,.32)}70%{box-shadow:0 0 0 14px rgba(16,179,179,0)}100%{box-shadow:0 0 0 0 rgba(16,179,179,0)}}
  .w.max .meter{animation:pulse 1.8s ease-out infinite}

  /* Matrix table – 固定、不可编辑 */
  .matrix{width:100%;border-collapse:separate;border-spacing:0 10px;margin-top:8px}
  .matrix th,.matrix td{background:#fff;border:1px solid #dcefe9;padding:12px;text-align:center}
  .matrix th{background:#f1fbf9;color:#0c5c52}
  .label{font-weight:800;text-align:left}
  tr.row{transition:.25s}
  tr.row:hover{transform:scale(1.01)}
  .score{font-weight:900}
  .win{outline:2px solid #10b3b3;box-shadow:0 0 0 3px rgba(16,179,179,.15) inset}

  .toolbar{display:flex;gap:12px;flex-wrap:wrap;margin:14px 0}
  .btn{cursor:pointer;border:none;padding:11px 16px;border-radius:10px;font-weight:900}
  .btn--primary{background:var(--brand2);color:#fff}
  .btn--ghost{background:#f4fbfa;border:1px solid #cdeee8;color:#0e6e63}

  footer{background:var(--brand);color:#fff;text-align:center;padding:18px}
</style>
</head>
<body>

<!-- NAV -->
<header>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>

      <li>
        <a href="research.html">Research</a>
        <div class="dropdown-content">
          <a href="research.html#background">Background</a>
          <a href="research.html#problem">Problem Description</a>
        </div>
      </li>

      <li>
        <a href="#">Design</a>
        <div class="dropdown-content">
          <div class="sub-dropdown">
            <a href="design-options.html">Design Solution Option ▸</a>
            <div class="sub-dropdown-content">
              <a href="solution1.html">Solution 1</a>
              <a href="solution2.html">Solution 2</a>
              <a href="solution3.html">Solution 3</a>
            </div>
          </div>
          <div class="sub-dropdown">
            <a href="design-selection.html">Design Selection ▸</a>
            <div class="sub-dropdown-content">
              <a href="selectionA.html">Solution A</a>
              <a href="selectionB.html">Solution B</a>
              <a href="selectionC.html">Solution C</a>
            </div>
          </div>
          <a href="detaileddesign.html">Detailed Design</a>
          <a href="prototype.html">Prototype</a>
        </div>
      </li>

      <li>
        <a href="#">Execution</a>
        <div class="dropdown-content">
          <a href="implementation.html">Implementation Plan</a>
          <a href="cost.html">Cost Analysis</a>
        </div>
      </li>

      <li>
        <a href="#">Insights</a>
        <div class="dropdown-content">
          <a href="other.html">Other Considerations</a>
          <a href="recommend.html">Recommendations</a>
        </div>
      </li>
    </ul>
  </nav>
</header>

<!-- HERO -->
<section class="hero">
  <h1>Design Selection</h1>
  <div class="breadcrumb">
    <a href="index.html">Home</a> <span class="sep">›</span> Design <span class="sep">›</span> Design Selection
  </div>
</section>

<main>
  <!-- 保持原文案 -->
  <section class="callout reveal">
    <p><strong>Evaluation focus:</strong> water quality safety & stability, reliability, initial building costs, maintenance costs, and scalability.</p>
    <p>For Saibai, <strong>safety & stability is weighted 0.25</strong> to ensure turbidity remains &lt; 1 NTU even during high-turbidity periods. <strong>Reliability is also 0.25</strong> so water can be supplied during dry seasons, power cuts or flooding. Given local technical & economic limits, <strong>building costs (0.20)</strong> and <strong>maintenance costs (0.15)</strong> must be considered. Because residents are dispersed, <strong>scalability (0.15)</strong> is also required.</p>
    <p><strong>Scoring method:</strong> Each criterion uses a discrete 1–5 scale (1 = not feasible, 3 = minimum standard, 5 = excellent). For cost-related criteria (building & maintenance), <em>lower is better</em> (handled by inverse scoring). Weighted totals are calculated as score × weight and then summed to compare options while reflecting criterion importance.</p>
  </section>

  <!-- Criteria & Weights：更清晰，但文字不变 -->
  <section class="reveal weights-wrap">
    <h2>Criteria & Weights</h2>
    <div class="weights">
      <div class="w" data-weight="25">
        <b>Safety & stability</b>
        <div class="pill">— target &lt; 1 NTU</div>
        <div class="meter"><div class="fill"></div></div>
        <span class="pct-chip">25%</span>
      </div>
      <div class="w" data-weight="25">
        <b>Reliability</b>
        <div class="pill">— dry season / outages</div>
        <div class="meter"><div class="fill"></div></div>
        <span class="pct-chip">25%</span>
      </div>
      <div class="w" data-weight="20">
        <b>Building costs</b>
        <div class="pill">— CapEx</div>
        <div class="meter"><div class="fill"></div></div>
        <span class="pct-chip">20%</span>
      </div>
      <div class="w" data-weight="15">
        <b>Maintenance costs</b>
        <div class="pill">— OpEx</div>
        <div class="meter"><div class="fill"></div></div>
        <span class="pct-chip">15%</span>
      </div>
      <div class="w" data-weight="15">
        <b>Scalability</b>
        <div class="pill">— dispersed households</div>
        <div class="meter"><div class="fill"></div></div>
        <span class="pct-chip">15%</span>
      </div>
    </div>

    <div class="toolbar">
      <button class="btn btn--ghost" onclick="location.href='detaileddesign.html'">See Detailed Design →</button>
      <span class="pill">Scale: 1–5 (higher is better, except costs are inverted)</span>
    </div>
  </section>

  <section class="reveal">
    <h2>Decision Matrix (Weighted Score)</h2>
    <table class="matrix">
      <tr>
        <th class="label">Alternative</th>
        <th>Safety & stability<br><span class="pill">× 0.25</span></th>
        <th>Reliability<br><span class="pill">× 0.25</span></th>
        <th>Building costs<br><span class="pill">× 0.20 (inv.)</span></th>
        <th>Maintenance costs<br><span class="pill">× 0.15 (inv.)</span></th>
        <th>Scalability<br><span class="pill">× 0.15</span></th>
        <th>Total</th>
      </tr>

      <tr class="row">
        <td class="label"><a href="selectionA.html">Solution A</a></td>
        <td>4.0</td><td>2.5</td><td>2.5</td><td>2.5</td><td>2.0</td>
        <td class="score" data-score="2.800">0.000</td>
      </tr>
      <tr class="row">
        <td class="label"><a href="selectionB.html">Solution B</a></td>
        <td>3.5</td><td>3.5</td><td>2.0</td><td>3.0</td><td>4.0</td>
        <td class="score" data-score="3.200">0.000</td>
      </tr>
      <tr class="row">
        <td class="label"><a href="selectionC.html">Solution C</a></td>
        <td>4.5</td><td>4.0</td><td>3.5</td><td>4.0</td><td>4.0</td>
        <td class="score" data-score="4.025">0.000</td>
      </tr>
    </table>

    <div class="toolbar">
      <button class="btn btn--primary" id="proceedBtn">Proceed with Top Solution</button>
      <button class="btn btn--ghost" onclick="location.href='design-options.html'">Back to Options</button>
    </div>
  </section>
</main>

<footer>© 2025 Team A — Saibai Island Alternative Water Harvesting Project</footer>

<script>
  // reveal on scroll
  const io = new IntersectionObserver(es=>es.forEach(e=>e.isIntersecting && e.target.classList.add('show')),{threshold:.2});
  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

  // 权重条动画 & 高亮最大值（25%）
  (function(){
    const cards = document.querySelectorAll('.w[data-weight]');
    const max = Math.max(...[...cards].map(c=>+c.dataset.weight||0));
    const io2 = new IntersectionObserver(es=>{
      es.forEach(e=>{
        if(e.isIntersecting){
          const el = e.target;
          el.querySelector('.fill').style.width = el.dataset.weight + '%';
          if(+el.dataset.weight === max) el.classList.add('max');
          io2.unobserve(el);
        }
      });
    },{threshold:.2});
    cards.forEach(c=>io2.observe(c));
  })();

  // 总分数字跳动 & 自动高亮冠军行
  (function(){
    const totals = Array.from(document.querySelectorAll('.score'));
    let best = {el:null,val:-1};
    totals.forEach(td=>{
      const target = parseFloat(td.dataset.score);
      if(target>best.val){best={el:td,val:target};}
      let cur = 0; const inc = Math.max(0.005, target/60);
      const tick = ()=>{ cur+=inc; if(cur>=target) cur=target; td.textContent = cur.toFixed(3); if(cur<target) requestAnimationFrame(tick); };
      requestAnimationFrame(tick);
    });
    const winRow = best.el.closest('tr');
    winRow.classList.add('win');
    document.getElementById('proceedBtn').onclick = ()=>{
      const name = winRow.querySelector('.label a').textContent.trim();
      const map = {'Solution A':'selectionA.html','Solution B':'selectionB.html','Solution C':'selectionC.html'};
      location.href = map[name] || 'detaileddesign.html';
    };
  })();
</script>
</body>
</html>
